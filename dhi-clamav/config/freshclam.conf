# FreshClam Configuration for DHI-ClamAV
# Automatic virus database updates

# Remove or comment out the Example line below
#Example

# Database directory
DatabaseDirectory /var/lib/clamav

# Update log file
UpdateLogFile /var/log/clamav/freshclam.log

# Enable verbose logging
LogVerbose false

# Enable log rotation
LogRotate true

# Log time with each message
LogTime true

# Use system logger (can work together with UpdateLogFile)
LogSyslog false

# Specify the type of syslog messages - use LOG_LOCAL6
LogFacility LOG_LOCAL6

# Enable PidFile
PidFile /var/run/clamav/freshclam.pid

# Database owner
DatabaseOwner clamav

# Allow supplementary groups
AllowSupplementaryGroups false

# Number of database checks per day
Checks 24

# Database mirror
DatabaseMirror db.local.clamav.net
DatabaseMirror database.clamav.net

# Maximum number of attempts to download database
MaxAttempts 5

# Use DNS to verify database version
DNSDatabaseInfo current.cvd.clamav.net

# Enable/disable local DNS caching
LocalIPAddress 0.0.0.0

# Timeout in seconds when connecting to database server
ConnectTimeout 30

# Timeout in seconds when reading from database server  
ReceiveTimeout 0

# Timeout for downloading a database file
DatabaseCustomURL https://database.clamav.net/main.cvd
DatabaseCustomURL https://database.clamav.net/daily.cvd
DatabaseCustomURL https://database.clamav.net/bytecode.cvd

# Enable/disable code for testing databases
TestDatabases yes

# Run command after successful database update
OnUpdateExecute /app/scripts/database-updated.sh

# Run command on database update error
OnErrorExecute /app/scripts/database-error.sh

# Run command on successful database download
OnOutdatedExecute /app/scripts/database-outdated.sh

# Enable/disable submission of detection stats
SubmitDetectionStats /var/lib/clamav/stats.dat

# Stats collection timeout
DetectionStatsCountry country-code

# Enable/disable automatic detection stats
DetectionStatsHostID auto

# Enable bytecode updates
Bytecode yes

# Enable unofficial signatures
# This would be enabled if using clamav-unofficial-sigs
# ExtraDatabase /var/lib/clamav-unofficial-sigs

# Proxy settings (if needed)
#HTTPProxyServer proxy.example.com
#HTTPProxyPort 8080
#HTTPProxyUsername username  
#HTTPProxyPassword password

# User agent for HTTP requests
HTTPUserAgent freshclam/0.99

# Compress DNS queries
CompressLocalDatabase yes

# Enable/disable SafeBrowsing
SafeBrowsing false

# Private local mirrors (if any)
#PrivateMirror mirror1.example.com
#PrivateMirror mirror2.example.com

# Foreground mode (for container use)
Foreground true

# Debug mode
Debug false