# ClamAV Daemon Configuration for DHI-ClamAV
# Optimized for container deployment and security scanning

# Remove or comment out the Example line below
#Example

# Path to the database directory
DatabaseDirectory /var/lib/clamav

# Path to a local socket file the daemon will listen on
LocalSocket /var/run/clamav/clamd.ctl

# Sets the group ownership on the unix socket
LocalSocketGroup clamav

# Sets the permissions on the unix socket to the specified mode
LocalSocketMode 666

# Remove stale socket after unclean shutdown
FixStaleSocket true

# TCP port address
TCPSocket 3310

# TCP address
TCPAddr 0.0.0.0

# Maximum length the queue of pending connections may grow to
MaxConnectionQueueLength 15

# Clamd uses FTP-like protocol to receive data from remote clients
StreamMaxLength 100M

# Maximum number of threads running at the same time
MaxThreads 20

# Waiting for data from a client socket will timeout after this time (seconds)
ReadTimeout 180

# Waiting for a new job will timeout after this time (seconds)
CommandReadTimeout 30

# This option specifies the time (in seconds) after which clamd should timeout if a client doesn't provide any initial command after connecting
SendBufTimeout 500

# Maximum number of queued clamd commands in the sequential command filter
MaxQueue 100

# Close the connection when the data size limit is exceeded
StreamMaxLength 100M

# Log additional information about the infected file, such as its size and hash
ExtendedDetectionInfo true

# With this option enabled ClamAV will load bytecode from the database if it is available
Bytecode true

# Set bytecode security level
BytecodeSecurity TrustSigned

# Set bytecode timeout in milliseconds
BytecodeTimeout 10000

# Perform a database check
SelfCheck 600

# Execute a command when virus is found
VirusEvent /app/scripts/virus-found.sh %v %f

# Run as another user (clamd must be started by root for this option to work)
User clamav

# Stop daemon when libclamav reports out of memory condition
AllowAllMatchScan true

# Foreground mode
Foreground true

# Enable debug messages in libclamav
Debug false

# Enable verbose logging
LogVerbose false

# Enable log rotation
LogRotate true

# Log file
LogFile /var/log/clamav/clamd.log

# Log time with each message
LogTime true

# Use system logger (can work together with LogFile)
LogSyslog false

# Specify the type of syslog messages
LogFacility LOG_LOCAL6

# Enable PidFile
PidFile /var/run/clamav/clamd.pid

# Temporary directory
TemporaryDirectory /tmp

# Database directory
DatabaseDirectory /var/lib/clamav

# Enable experimental features
ExcludePath ^/proc/
ExcludePath ^/sys/
ExcludePath ^/dev/

# File size limit
MaxFileSize 100M

# Recursion level limit
MaxRecursion 16

# Number of files to be scanned within an archive
MaxFiles 10000

# Enable scanning of mail files
ScanMail true

# Enable scanning of OLE2 files
ScanOLE2 true

# Enable scanning of PDF files  
ScanPDF true

# Enable scanning of SWF files
ScanSWF true

# Enable scanning of HTML files
ScanHTML true

# Enable scanning of archive files
ScanArchive true

# Scan archives
MaxScanSize 500M

# Maximum size of files inside archives that will be marked as infected if archives are of a malicious type
MaxPartitions 50

# Maximum number of partitions
MaxIconsPE 100

# Maximum size of HTML file to normalize
MaxHTMLNormalize 10M

# Maximum size of normalized HTML file to scan
MaxHTMLNoTags 2M

# Maximum size of script file to normalize
MaxScriptNormalize 5M

# Maximum size of ZIP file to reanalyze type recognition
MaxZipTypeRcg 1M

# Perform heuristic checks whenever a heuristic signature is matched
HeuristicScanPrecedence false

# Allow heuristic alerts
StructuredDataDetection false

# Data Loss Prevention
StructuredSSNFormatNormal true
StructuredSSNFormatStripped true
StructuredCCFormatNormal true
StructuredCCFormatStripped true

# PhishingScanURLs
PhishingSignatures true
PhishingScanURLs true

# Enable the DLP module
StructuredDataDetection false

# Executable packer limits
MaxEmbeddedPE 40M
MaxHTMLNormalize 40M