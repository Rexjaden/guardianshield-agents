# OpenVPN Configuration for GuardianShield Validator Network
# Ultra-secure VPN access to validator infrastructure

port 1194
proto udp
dev tun

# SSL/TLS root certificate (ca), certificate (cert), and private key (key)
ca /etc/openvpn/pki/ca.crt
cert /etc/openvpn/pki/issued/server.crt
key /etc/openvpn/pki/private/server.key
dh /etc/openvpn/pki/dh.pem

# Network configuration for validators
server 10.8.0.0 255.255.255.0
ifconfig-pool-persist /etc/openvpn/ipp.txt

# Push routes to validator private network
push "route 172.20.0.0 255.255.0.0"
push "route 10.0.0.0 255.0.0.0"

# Enable clients to see each other
client-to-client

# Keep connection alive
keepalive 10 120

# Cryptographic cipher - use strongest available
cipher AES-256-GCM
auth SHA512
tls-crypt /etc/openvpn/pki/tc.key

# Security hardening
tls-version-min 1.2
tls-cipher TLS-ECDHE-ECDSA-WITH-AES-256-GCM-SHA384:TLS-ECDHE-RSA-WITH-AES-256-GCM-SHA384
ecdh-curve prime256v1

# Disable compression (security)
compress

# Privilege separation
user nobody
group nogroup

# Persistence
persist-key
persist-tun

# Logging
status /var/log/openvpn/openvpn-status.log
log-append /var/log/openvpn/openvpn.log
verb 3
mute 20

# Rate limiting to prevent DoS
connect-freq 1 10

# Client verification script
script-security 2
auth-user-pass-verify /etc/openvpn/scripts/auth-validator.sh via-env
client-cert-not-required
username-as-common-name

# Validator-specific routing
client-config-dir /etc/openvpn/ccd

# Security policies
duplicate-cn
max-clients 10